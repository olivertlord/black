tco=1;
clear deltecx deltax;

for i=1:mxrow
    
    if(em>0)
      deltecx(amc,i)=deltec(amc,i)-2.;
      ctempem(i)=tempec(amc,i) - (-0.0216*(deltecx(amc,i)*deltecx(amc,i))+17.882*deltecx(amc,i));    
    else
      deltax(i)=delta(i)-2.;
      ctemp(i)=temp(i) - (-0.0216*(deltax(i)*deltax(i))+17.882*deltax(i));
    end;
    
end;

prec=15;
  
 if(em>0)
    subplot('position',[0.28,0.07,0.67,0.56])
    %set(gcf,'DefaultAxesColorOrder',[1 0 0;0 1 0;0 0 1])
    %errorbar(xrange(mnrow:mxrow),ctempem(mnrow:mxrow),prec,colers(cnt));
    plot(xrange(mnrow:mxrow),ctempem(mnrow:mxrow), colers(cnt),'LineWidth',2);
    grid on;
    xlabel('pixel'), ylabel('Temp (K)')
    set(gca,'NextPlot','add');
    
    mx=max(ctempem(mnrow:mxrow));
    mn=min(ctempem(mnrow:mxrow));
    av=mean(ctempem(mnrow:mxrow));
    
 else
     
    subplot('position',[0.28,0.07,0.67,0.56])
    %set(gcf,'DefaultAxesColorOrder',[1 0 0;0 1 0;0 0 1])
    %errorbar(xrange(mnrow:mxrow),ctemp(mnrow:mxrow),prec,colers(cnt));
    plot(xrange(mnrow:mxrow),ctemp(mnrow:mxrow), colers(cnt), 'LineWidth',2);
    grid on;
    xlabel('pixel'), ylabel('Temp (K)')
    set(gca,'NextPlot','add');
    
    mx=max(ctemp(mnrow:mxrow));
    mn=min(ctemp(mnrow:mxrow));
    av=mean(ctemp(mnrow:mxrow));

 end;
 
    h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[175 300 50 12], ...
	'String','maxtemp = ', ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');
     h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[225 300 40 12], ...
	'String',mx, ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');

    h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[175 290 50 12], ...
	'String','mintemp = ', ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');
    h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[225 290 40 12], ...
	'String',mn, ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');

    h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[175 280 50 12], ...
	'String','avetemp = ', ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');
    h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[225 280 40 12], ...
	'String',av, ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');

 h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[175 270 50 12], ...
	'String','aveerr = ', ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');
    h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[225 270 40 12], ...
	'String','n/a', ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');

 
 em=0;