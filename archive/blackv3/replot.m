rp=0;

figure(h0),
  subplot('position',[0.28,0.07,0.67,0.56])
  errorbar(xrange(mnrow:mxrow),tempec(amc,mnrow:mxrow),deltec(amc,mnrow:mxrow),colers(cnt));
  grid on;
  xlabel('pixel'), ylabel('Temp (K)')
  set(gca,'NextPlot','add');

mnlam=win+((amc-1)*10);
mxlam=mnlam+wra;

lpix=round(conl + lam1.*mnlam + lam2.*mnlam.^2);
hpix=round(conl + lam1.*mxlam + lam2.*mxlam.^2);
  
  
figure(h0),
  subplot('position',[0.28,0.72,0.67,0.25])
  set(gcf,'DefaultAxesColorOrder',[0 0 1])
  plot(omega(1,lpix:hpix),j(lpix:hpix,mnrow:mxrow));
  xlabel('omega'), ylabel('J'); 
  set(gca,'NextPlot','replacechildren');


%avetemp(cnt)=mean(temp(mnrow:mxrow));
%errave(cnt)=mean(delta(mnrow:mxrow));
%maxtemp(cnt)=max(temp(mnrow:mxrow));
%mintemp(cnt)=min(temp(mnrow:mxrow));
%stdtemp(cnt)=std(temp(mnrow:mxrow));

 mx=max(tempec(amc,mnrow:mxrow));
 mn=min(tempec(amc,mnrow:mxrow));
 av=mean(tempec(amc,mnrow:mxrow));
 sd=std(tempec(amc,mnrow:mxrow));
 ea=mean(deltec(amc,mnrow:mxrow));
   
    h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[175 300 50 12], ...
	'String','maxtemp = ', ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');
     h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[225 300 40 12], ...
	'String',mx, ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');

    h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[175 290 50 12], ...
	'String','mintemp = ', ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');
    h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[225 290 40 12], ...
	'String',mn, ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');

    h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[175 280 50 12], ...
	'String','avetemp = ', ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');
    h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[225 280 40 12], ...
	'String',av, ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');


    h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[175 270 50 12], ...
	'String','aveerr = ', ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');
    h1 = uicontrol('Parent',h0, ...
	'Units','points', ...
    'BackgroundColor',[0.8 0.8 0.8], ...
	'FontName','Geneva', ...
	'FontSize',8, ...
	'Position',[225 270 40 12], ...
	'String',ea, ...
	'Style','text', ...
    'HandleVisibility', 'on',...
	'Tag','StaticText1');

rp=rp+1;

if(rp==1) close(he); close(he0); end;